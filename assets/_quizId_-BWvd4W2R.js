import{K as e,W as t,n,s as r,w as i,x as a,y as o}from"./index-DkHy_0vr.js";import{t as s}from"./createLucideIcon-CjtwccN9.js";import{t as c}from"./square-pen-Bvk2UZNB.js";import{i as l,n as u,r as d,t as f}from"./card-BBO2aCaD.js";import{t as p}from"./button-CVZMqZS2.js";import{t as m}from"./badge-rej1Ruiq.js";var h=s(`chart-column`,[[`path`,{d:`M3 3v16a2 2 0 0 0 2 2h16`,key:`c24i48`}],[`path`,{d:`M18 17V9`,key:`2bz60n`}],[`path`,{d:`M13 17V5`,key:`1frdt8`}],[`path`,{d:`M8 17v-3`,key:`17ska0`}]]),g=s(`circle-check-big`,[[`path`,{d:`M21.801 10A10 10 0 1 1 17 3.335`,key:`yps3ct`}],[`path`,{d:`m9 11 3 3L22 4`,key:`1pflzl`}]]),_=s(`circle-x`,[[`circle`,{cx:`12`,cy:`12`,r:`10`,key:`1mglay`}],[`path`,{d:`m15 9-6 6`,key:`1uzhvr`}],[`path`,{d:`m9 9 6 6`,key:`z0biqf`}]]),v=e(t()),y=e(i()),b=(({quiz:e})=>(0,y.jsxs)(f,{children:[(0,y.jsx)(d,{children:(0,y.jsx)(l,{className:`text-2xl`,children:e.title})}),(0,y.jsxs)(u,{className:`space-y-4`,children:[e.description&&(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Description`}),(0,y.jsx)(`p`,{className:`mt-1`,children:e.description})]}),(0,y.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Questions`}),(0,y.jsx)(`p`,{className:`mt-1`,children:e.questionCount??0})]}),(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Time Limit`}),(0,y.jsx)(`p`,{className:`mt-1`,children:e.timeLimit?`${e.timeLimit} minutes`:`No time limit`})]}),(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Max Attempts`}),(0,y.jsx)(`p`,{className:`mt-1`,children:e.maxAttempts?e.maxAttempts:`Unlimited`})]}),e.passingScore&&(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Passing Score`}),(0,y.jsxs)(`p`,{className:`mt-1`,children:[e.passingScore,`%`]})]})]})]})]})),x=(({attempt:e,quiz:t,showCorrectAnswers:n})=>{let r=e.score??0,i=e.maxScore??1,a=r/i*100,o=t.passingScore===null?!1:a>=t.passingScore;return(0,y.jsxs)(`div`,{className:`space-y-6`,children:[(0,y.jsxs)(f,{children:[(0,y.jsx)(d,{children:(0,y.jsxs)(l,{className:`flex items-center justify-between`,children:[(0,y.jsx)(`span`,{children:`Quiz Results`}),t.passingScore!==null&&(0,y.jsx)(y.Fragment,{children:o?(0,y.jsx)(m,{variant:`default`,className:`text-base`,children:`Passed`}):(0,y.jsx)(m,{variant:`destructive`,className:`text-base`,children:`Not Passed`})})]})}),(0,y.jsx)(u,{children:(0,y.jsxs)(`div`,{className:`space-y-2`,children:[(0,y.jsxs)(`div`,{className:`flex items-center justify-between text-lg`,children:[(0,y.jsx)(`span`,{className:`font-semibold`,children:`Score:`}),(0,y.jsxs)(`span`,{children:[r,` / `,i,` (`,a.toFixed(1),`%)`]})]}),e.submittedAt&&(0,y.jsxs)(`div`,{className:`text-sm text-muted-foreground`,children:[`Submitted: `,new Date(e.submittedAt).toLocaleString()]})]})})]}),n&&e.answers&&(0,y.jsxs)(`div`,{className:`space-y-4`,children:[(0,y.jsx)(`h3`,{className:`text-lg font-semibold`,children:`Answer Review`}),e.answers.map((e,t)=>(0,y.jsxs)(f,{children:[(0,y.jsx)(d,{children:(0,y.jsxs)(`div`,{className:`flex items-start justify-between`,children:[(0,y.jsxs)(l,{className:`text-base`,children:[`Question `,t+1]}),(0,y.jsxs)(`div`,{className:`flex items-center gap-2`,children:[e.isCorrect!==null&&(0,y.jsx)(y.Fragment,{children:e.isCorrect?(0,y.jsx)(g,{className:`h-5 w-5 text-green-600`}):(0,y.jsx)(_,{className:`h-5 w-5 text-red-600`})}),(0,y.jsxs)(`span`,{className:`text-sm text-muted-foreground`,children:[e.pointsAwarded??0,` points`]})]})]})}),(0,y.jsxs)(u,{className:`space-y-2`,children:[(0,y.jsx)(`p`,{className:`font-medium`,children:e.questionText}),(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Your answer:`}),(0,y.jsx)(`p`,{className:`text-sm`,children:Array.isArray(e.answer)?e.answer.join(`, `):e.answer?.toString()??`No answer`})]}),e.correctAnswer!==void 0&&(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`p`,{className:`text-sm text-muted-foreground`,children:`Correct answer:`}),(0,y.jsx)(`p`,{className:`text-sm font-medium text-green-600`,children:Array.isArray(e.correctAnswer)?e.correctAnswer.join(`, `):e.correctAnswer?.toString()??`N/A`})]})]})]},t))]})]})});const S=()=>{let{quizId:e}=a(),t=e?parseInt(e,10):null,i=r(e=>e.courses.currentCourseId),s=o(),[l,u]=(0,v.useState)(null),[d,f]=(0,v.useState)([]),[m,g]=(0,v.useState)(!0);(0,v.useEffect)(()=>{(async()=>{if(!(!i||!t)){g(!0);try{let[e,r]=await Promise.all([n.GET(`/api/v1/courses/{courseId}/quizzes/{quizId}`,{params:{path:{courseId:i,quizId:t}}}),n.GET(`/api/v1/courses/{courseId}/quizzes/{quizId}/my-attempts`,{params:{path:{courseId:i,quizId:t}}})]);u(e.data??null),f(r.data??[])}catch(e){console.error(`Failed to fetch quiz data:`,e)}finally{g(!1)}}})()},[i,t]);let _=async()=>{if(!(!i||!t))try{let e=await n.POST(`/api/v1/courses/{courseId}/quizzes/{quizId}/attempts`,{params:{path:{courseId:i,quizId:t}}});e.data&&s(`/courses/${i}/quizzes/${t}/attempt/${e.data.id}`)}catch(e){console.error(`Failed to start quiz:`,e)}},S=e=>{s(`/courses/${i}/quizzes/${t}/attempt/${e}`)};return m?(0,y.jsx)(`div`,{className:`max-w-5xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,y.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,y.jsx)(`p`,{className:`text-muted-foreground`,children:`Loading quiz...`})})}):l?(0,y.jsxs)(`div`,{className:`max-w-5xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:[(0,y.jsxs)(`div`,{className:`sticky top-0 bg-background pt-8 pb-4 z-10`,children:[(0,y.jsx)(p,{variant:`ghost`,onClick:()=>s(`/courses/${i}/quizzes`),className:`mb-4`,children:`â† Back to Quizzes`}),(0,y.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,y.jsx)(`h1`,{className:`text-2xl font-bold`,children:l.title}),(0,y.jsxs)(`div`,{className:`flex gap-2`,children:[(0,y.jsxs)(p,{variant:`outline`,size:`sm`,onClick:()=>s(`/courses/${i}/quizzes/${t}/manage`),children:[(0,y.jsx)(h,{className:`h-4 w-4 mr-2`}),`Manage`]}),(0,y.jsxs)(p,{variant:`outline`,size:`sm`,onClick:()=>s(`/courses/${i}/quizzes/${t}/edit`),children:[(0,y.jsx)(c,{className:`h-4 w-4 mr-2`}),`Edit`]})]})]})]}),(0,y.jsxs)(`div`,{className:`space-y-6`,children:[(0,y.jsx)(b,{quiz:l}),d.length>0&&(0,y.jsxs)(`div`,{className:`space-y-4`,children:[(0,y.jsx)(`h2`,{className:`text-xl font-semibold`,children:`Your Attempts`}),d.map(e=>(0,y.jsx)(x,{attempt:e,quiz:l,showCorrectAnswers:l.showCorrectAnswers},e.id))]}),(0,y.jsx)(`div`,{className:`flex justify-center pt-4`,children:d.find(e=>!e.isCompleted)?(0,y.jsx)(p,{onClick:()=>S(d.find(e=>!e.isCompleted).id),size:`lg`,children:`Continue In-Progress Attempt`}):(0,y.jsx)(p,{onClick:_,size:`lg`,children:d.length>0?`Start New Attempt`:`Start Quiz`})})]})]}):(0,y.jsx)(`div`,{className:`max-w-5xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,y.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,y.jsx)(`p`,{className:`text-muted-foreground`,children:`Quiz not found.`})})})};S.displayName=`QuizDetail`;var C=S;export{S as Component,C as default};