import{t as e}from"./hooks-CYRrV7oD.js";import{K as t,W as n,s as r,t as i,w as a,x as o,y as s}from"./index-DkHy_0vr.js";import{a as c,i as l,n as u,r as d,t as f}from"./select-zJHlb6nx.js";import{t as p}from"./x-C4Quvcz0.js";import{r as m}from"./dist-UfzXyJyC.js";import{i as h,n as g,r as _,t as v}from"./card-BBO2aCaD.js";import{a as y,i as b,n as x,o as S,r as C,t as w}from"./table-BMtXcUaF.js";import{t as T}from"./button-CVZMqZS2.js";import"./es2015-DqD72R9q.js";import{t as E}from"./input-D350uBQc.js";var D=t(n()),O=t(a()),k=(({attempts:e})=>(0,O.jsxs)(w,{children:[(0,O.jsx)(y,{children:(0,O.jsxs)(S,{children:[(0,O.jsx)(b,{children:`Student`}),(0,O.jsx)(b,{children:`Role`}),(0,O.jsx)(b,{children:`Status`}),(0,O.jsx)(b,{children:`Started`}),(0,O.jsx)(b,{children:`Submitted`}),(0,O.jsx)(b,{children:`Score`}),(0,O.jsx)(b,{children:`Result`})]})}),(0,O.jsx)(x,{children:e.length===0?(0,O.jsx)(S,{children:(0,O.jsx)(C,{colSpan:7,className:`text-center text-muted-foreground`,children:`No attempts found`})}):e.map(e=>(0,O.jsxs)(S,{children:[(0,O.jsx)(C,{children:(0,O.jsxs)(`div`,{children:[(0,O.jsx)(`div`,{className:`font-medium`,children:e.student.name}),(0,O.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:e.student.email})]})}),(0,O.jsx)(C,{children:e.student.role}),(0,O.jsx)(C,{children:e.isCompleted?(0,O.jsx)(`span`,{className:`text-green-600`,children:`Completed`}):(0,O.jsx)(`span`,{className:`text-yellow-600`,children:`In Progress`})}),(0,O.jsx)(C,{children:new Date(e.startedAt).toLocaleString()}),(0,O.jsx)(C,{children:e.submittedAt?new Date(e.submittedAt).toLocaleString():`-`}),(0,O.jsxs)(C,{children:[e.score!==null&&e.maxScore!==null?`${e.score}/${e.maxScore}`:`-`,e.percentage!==null&&(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground ml-2`,children:[`(`,e.percentage.toFixed(1),`%)`]})]}),(0,O.jsxs)(C,{children:[e.passed===!0&&(0,O.jsx)(`span`,{className:`text-green-600 font-medium`,children:`Passed`}),e.passed===!1&&(0,O.jsx)(`span`,{className:`text-red-600 font-medium`,children:`Failed`}),e.passed===null&&(0,O.jsx)(`span`,{children:`-`})]})]},e.attemptId))})]})),A=(({statistics:e})=>(0,O.jsxs)(`div`,{className:`grid grid-cols-2 md:grid-cols-4 gap-4`,children:[(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(h,{className:`text-sm font-medium`,children:`Total Attempts`})}),(0,O.jsx)(g,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.totalAttempts})})]}),(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(h,{className:`text-sm font-medium`,children:`Completed`})}),(0,O.jsx)(g,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.completedAttempts})})]}),(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(h,{className:`text-sm font-medium`,children:`Average Score`})}),(0,O.jsx)(g,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.averageScore===null?`N/A`:`${e.averageScore.toFixed(1)}%`})})]}),(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(h,{className:`text-sm font-medium`,children:`Passing Rate`})}),(0,O.jsx)(g,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.passingRate===null?`N/A`:`${e.passingRate.toFixed(1)}%`})})]})]}));const j=()=>{let{quizId:t}=o(),n=t?parseInt(t,10):null,a=r(e=>e.courses.currentCourseId),y=s(),[b,x]=(0,D.useState)(``),[S,C]=(0,D.useState)(``),{data:w,isLoading:j}=e({...i.quizzes.statistics(a,n),errorMessage:`Failed to load quiz statistics`,fallbackValue:null,enabled:!!a&&!!n});if(j)return(0,O.jsx)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,O.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,O.jsx)(`p`,{className:`text-muted-foreground`,children:`Loading statistics...`})})});if(!w)return(0,O.jsx)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,O.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,O.jsx)(`p`,{className:`text-muted-foreground`,children:`No statistics available.`})})});let M=w.attempts.filter(e=>{let t=e.student.name.toLowerCase().includes(b.toLowerCase())||e.student.email.toLowerCase().includes(b.toLowerCase()),n=!S||e.student.role===S;return t&&n}),N=Array.from(new Set(w.attempts.map(e=>e.student.role)));return(0,O.jsxs)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:[(0,O.jsxs)(`div`,{className:`sticky top-0 bg-background pt-8 pb-4 z-10`,children:[(0,O.jsx)(T,{variant:`ghost`,onClick:()=>y(`/courses/${a}/quizzes/${n}`),className:`mb-4`,children:`â† Back to Quiz`}),(0,O.jsxs)(`h1`,{className:`text-2xl font-bold`,children:[w.quizTitle,` - Management`]})]}),(0,O.jsxs)(`div`,{className:`space-y-6`,children:[(0,O.jsx)(A,{statistics:w}),w.highestScore!==null&&w.lowestScore!==null&&(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(h,{children:`Score Range`})}),(0,O.jsx)(g,{children:(0,O.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,O.jsxs)(`div`,{children:[(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground`,children:[`Highest:`,` `]}),(0,O.jsxs)(`span`,{className:`text-lg font-semibold`,children:[w.highestScore.toFixed(1),`%`]})]}),(0,O.jsxs)(`div`,{children:[(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground`,children:[`Lowest:`,` `]}),(0,O.jsxs)(`span`,{className:`text-lg font-semibold`,children:[w.lowestScore.toFixed(1),`%`]})]})]})})]}),(0,O.jsxs)(v,{children:[(0,O.jsx)(_,{children:(0,O.jsxs)(h,{children:[`Attempts (`,M.length,`)`]})}),(0,O.jsxs)(g,{className:`space-y-4`,children:[(0,O.jsxs)(`div`,{className:`flex gap-4`,children:[(0,O.jsx)(`div`,{className:`flex-1`,children:(0,O.jsx)(E,{placeholder:`Search by name or email...`,value:b,onChange:e=>x(e.target.value)})}),(0,O.jsxs)(`div`,{className:`flex gap-x-1`,children:[(0,O.jsxs)(f,{value:S,onValueChange:C,children:[(0,O.jsx)(l,{className:m(S?`w-35`:`w-45`),children:(0,O.jsx)(c,{placeholder:`All Roles`})}),(0,O.jsx)(u,{children:N.map(e=>(0,O.jsx)(d,{value:e,children:e},e))})]}),S&&(0,O.jsx)(T,{variant:`outline`,className:`hover:text-destructive`,onClick:()=>C(``),size:`icon`,children:(0,O.jsx)(p,{})})]})]}),(0,O.jsx)(`div`,{className:`border rounded-lg overflow-hidden`,children:(0,O.jsx)(k,{attempts:M})})]})]})]})]})};j.displayName=`ManageQuiz`;var M=j;export{j as Component,M as default};