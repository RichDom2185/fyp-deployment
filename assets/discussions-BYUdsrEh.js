import{n as e}from"./hooks-CYRrV7oD.js";import{C as t,K as n,W as r,f as i,n as a,s as o,t as s,w as c}from"./index-DkHy_0vr.js";import{t as l}from"./plus-C1Kf0VHO.js";import{t as u}from"./button-CVZMqZS2.js";import"./es2015-DqD72R9q.js";import{a as d,o as f,r as p,s as m,t as h}from"./dialog-DV4qlhuR.js";import{t as g}from"./input-D350uBQc.js";import"./shim-CTE6O2qI.js";import{n as _,r as v,t as y}from"./avatar-DgTxZQgq.js";import{t as b}from"./badge-rej1Ruiq.js";import{t as x}from"./textarea-DnKqqzBp.js";var S=n(r()),C=n(c()),w=(({open:e,onOpenChange:t,handleSubmit:n})=>{let[r,i]=(0,S.useState)(``),[a,o]=(0,S.useState)(``),[s,c]=(0,S.useState)(!1);return(0,C.jsx)(h,{open:e,onOpenChange:t,children:(0,C.jsxs)(p,{children:[(0,C.jsx)(f,{children:(0,C.jsx)(m,{children:`Add New Discussion`})}),(0,C.jsxs)(`div`,{className:`space-y-4`,children:[(0,C.jsx)(g,{type:`text`,placeholder:`Title`,value:r,onChange:e=>i(e.target.value)}),(0,C.jsx)(x,{placeholder:`Description`,value:a,onChange:e=>o(e.target.value)})]}),(0,C.jsx)(d,{children:(0,C.jsx)(u,{type:`submit`,onClick:async()=>{c(!0);try{await n(r,a),i(``),o(``)}catch(e){console.error(`Error adding discussion:`,e),window.alert(`Failed to add discussion. Please try again.`)}finally{c(!1)}},disabled:!r.trim()||!a.trim()||s,children:`Submit`})})]})})}),T=()=>[`General`,`Question`],E=e=>new Date(e).toLocaleDateString(`en-US`,{month:`short`,day:`numeric`,year:`numeric`}),D=(({discussions:e})=>(0,C.jsx)(`div`,{className:`space-y-4`,children:e.length===0?(0,C.jsx)(`p`,{className:`pl-4 py-2 text-sm text-muted-foreground`,children:`No discussions yet.`}):(0,C.jsx)(`ul`,{className:`space-y-3`,children:e.map(e=>(0,C.jsx)(`li`,{className:`border rounded-lg p-4 hover:bg-accent/50 transition-colors`,children:(0,C.jsxs)(i,{to:`${e.id}`,className:`block`,children:[(0,C.jsx)(`h3`,{className:`font-semibold text-lg hover:underline flex-1 mb-2`,children:e.title}),(0,C.jsxs)(`div`,{className:`flex items-center gap-x-2 text-sm text-muted-foreground mb-2`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,C.jsxs)(y,{className:`h-6 w-6`,children:[(0,C.jsx)(v,{src:e.author.avatarUrl}),(0,C.jsx)(_,{children:e.author.name[0]||`A`})]}),(0,C.jsx)(`span`,{children:e.author.name||`Anonymous`})]}),(0,C.jsx)(`span`,{children:`â€¢`}),(0,C.jsx)(`time`,{children:E(e.createdAt)})]}),(0,C.jsx)(`p`,{className:`mb-3 text-muted-foreground text-sm line-clamp-2 truncate whitespace-normal`,children:e.description||`No description provided.`}),(0,C.jsx)(`div`,{className:`flex gap-2 flex-wrap`,children:T().map(e=>(0,C.jsx)(b,{variant:`secondary`,className:`text-xs`,children:e},e))})]})},e.id))})}));function O({onSuccess:n,onError:r}={}){let i=t();return e({mutationFn:async({courseId:e,title:t,description:n})=>{let r=await a.POST(`/api/v1/discussions`,{body:{courseId:e,title:t,description:n}});if(r.error)throw Error(`Failed to create discussion`);return r.data},errorMessage:`Failed to create discussion`,showSuccessToast:!0,successMessage:`Discussion created successfully`,onSuccess:()=>{i.invalidateQueries({queryKey:s.discussions._def}),n?.()},onError:r})}const k=()=>{let e=o(e=>e.courses.currentCourseId),t=o(e=>e.discussions.discussions),[n,r]=(0,S.useState)(!1),i=O({onSuccess:()=>{r(!1)}});return(0,C.jsxs)(`div`,{className:`max-w-3xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:[(0,C.jsxs)(`div`,{className:`flex items-center justify-between sticky top-0 bg-background pt-8 pb-4 z-10`,children:[(0,C.jsx)(`h1`,{className:`text-2xl font-bold`,children:`Discussions`}),(0,C.jsxs)(u,{onClick:()=>r(!0),children:[(0,C.jsx)(l,{}),`Create New Discussion`]})]}),(0,C.jsx)(D,{discussions:t}),(0,C.jsx)(w,{open:n,onOpenChange:r,handleSubmit:(t,n)=>{e&&i.mutate({courseId:e,title:t,description:n})}})]})};k.displayName=`Discussion`;var A=k;export{k as Component,A as default};