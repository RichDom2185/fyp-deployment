var e=[],t=0,n=4;let r=0;const i=i=>{let a=[],o={get(){return o.lc||o.listen(()=>{})(),o.value},lc:0,listen(r){return o.lc=a.push(r),()=>{for(let i=t+n;i<e.length;)e[i]===r?e.splice(i,n):i+=n;let i=a.indexOf(r);~i&&(a.splice(i,1),--o.lc||o.off())}},notify(i,s){r++;let c=!e.length;for(let t of a)e.push(t,o.value,i,s);if(c){for(t=0;t<e.length;t+=n)e[t](e[t+1],e[t+2],e[t+3]);e.length=0}},off(){},set(e){let t=o.value;t!==e&&(o.value=e,o.notify(t))},subscribe(e){let t=o.listen(e);return e(o.value),t},value:i};return o};var a=5,o=6,s=10;let c=(e,t,n,r)=>(e.events=e.events||{},e.events[n+s]||(e.events[n+s]=r(t=>{e.events[n].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[n]=e.events[n]||[],e.events[n].push(t),()=>{let r=e.events[n],i=r.indexOf(t);r.splice(i,1),r.length||(delete e.events[n],e.events[n+s](),delete e.events[n+s])}),l=(e,t)=>c(e,n=>{let r=t(n);r&&e.events[o].push(r)},a,t=>{let n=e.listen;e.listen=(...r)=>(!e.lc&&!e.active&&(e.active=!0,t()),n(...r));let r=e.off;return e.events[o]=[],e.off=()=>{r(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let t of e.events[o])t();e.events[o]=[]}},1e3)},()=>{e.listen=n,e.off=r}});var u=e=>e,d={},f={addEventListener(){},removeEventListener(){}};function p(){try{return typeof localStorage<`u`}catch{return!1}}p()&&(d=localStorage),typeof window<`u`&&(f={addEventListener(e,t,n){window.addEventListener(`storage`,t),window.addEventListener(`pageshow`,n)},removeEventListener(e,t,n){window.removeEventListener(`storage`,t),window.removeEventListener(`pageshow`,n)}});function m(e,t=void 0,n={}){let r=n.encode||u,a=n.decode||u,o=d[e],s=i(e in d?a(o):t),c=s.set;s.set=t=>{o=r(t),o===void 0?delete d[e]:d[e]=o,c(t)};function p(n){n.key===e?n.newValue===null?c(t):c(a(n.newValue)):d[e]||c(t)}function m(){o!==d[e]&&s.set(e in d?a(d[e]):t)}return l(s,()=>{if(m(),n.listen!==!1)return f.addEventListener(e,p,m),()=>{f.removeEventListener(e,p,m)}}),s}var h={auth:(()=>{let e=i(null);return{setUserId:e.set,getUserId:e.get}})(),recentRooms:(()=>{let e=m(`recentRooms`,[],{encode:JSON.stringify,decode:e=>{try{return JSON.parse(e||`[]`)}catch{return[]}}});return{list:()=>e.get(),add:t=>{let n=e.get();n.includes(t)||e.set([t,...n])},clear:()=>e.set([])}})()};export{h as t};