import{t as e}from"./hooks-BVZKHwJG.js";import{K as t,T as n,Z as r,s as i,t as a,x as o,y as s}from"./index-De71N5Dy.js";import{t as c}from"./utils-BVdesv7M.js";import{t as l}from"./button-DPMtwoy8.js";import{a as u,i as d,n as f,r as p,t as m}from"./select-BpqZ3j4F.js";import{t as h}from"./x-BvgmIxFh.js";import{t as g}from"./input-BU6q5fO9.js";import"./es2015-nRZsoKYs.js";import{a as _,n as v,o as y,t as b}from"./card-D2-K7jj_.js";import{a as x,i as S,n as C,o as w,r as T,t as E}from"./table-rrTSX0KC.js";var D=r(t()),O=r(n());function k({attempts:e}){return(0,O.jsxs)(E,{children:[(0,O.jsx)(x,{children:(0,O.jsxs)(w,{children:[(0,O.jsx)(S,{children:`Student`}),(0,O.jsx)(S,{children:`Role`}),(0,O.jsx)(S,{children:`Status`}),(0,O.jsx)(S,{children:`Started`}),(0,O.jsx)(S,{children:`Submitted`}),(0,O.jsx)(S,{children:`Score`}),(0,O.jsx)(S,{children:`Result`})]})}),(0,O.jsx)(C,{children:e.length===0?(0,O.jsx)(w,{children:(0,O.jsx)(T,{colSpan:7,className:`text-center text-muted-foreground`,children:`No attempts found`})}):e.map(e=>(0,O.jsxs)(w,{children:[(0,O.jsx)(T,{children:(0,O.jsxs)(`div`,{children:[(0,O.jsx)(`div`,{className:`font-medium`,children:e.student.name}),(0,O.jsx)(`div`,{className:`text-sm text-muted-foreground`,children:e.student.email})]})}),(0,O.jsx)(T,{children:e.student.role}),(0,O.jsx)(T,{children:e.isCompleted?(0,O.jsx)(`span`,{className:`text-green-600`,children:`Completed`}):(0,O.jsx)(`span`,{className:`text-yellow-600`,children:`In Progress`})}),(0,O.jsx)(T,{children:new Date(e.startedAt).toLocaleString()}),(0,O.jsx)(T,{children:e.submittedAt?new Date(e.submittedAt).toLocaleString():`-`}),(0,O.jsxs)(T,{children:[e.score!==null&&e.maxScore!==null?`${e.score}/${e.maxScore}`:`-`,e.percentage!==null&&(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground ml-2`,children:[`(`,e.percentage.toFixed(1),`%)`]})]}),(0,O.jsxs)(T,{children:[e.passed===!0&&(0,O.jsx)(`span`,{className:`text-green-600 font-medium`,children:`Passed`}),e.passed===!1&&(0,O.jsx)(`span`,{className:`text-red-600 font-medium`,children:`Failed`}),e.passed===null&&(0,O.jsx)(`span`,{children:`-`})]})]},e.attemptId))})]})}var A=k;function j({statistics:e}){return(0,O.jsxs)(`div`,{className:`grid grid-cols-2 md:grid-cols-4 gap-4`,children:[(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(y,{className:`text-sm font-medium`,children:`Total Attempts`})}),(0,O.jsx)(v,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.totalAttempts})})]}),(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(y,{className:`text-sm font-medium`,children:`Completed`})}),(0,O.jsx)(v,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.completedAttempts})})]}),(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(y,{className:`text-sm font-medium`,children:`Average Score`})}),(0,O.jsx)(v,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.averageScore===null?`N/A`:`${e.averageScore.toFixed(1)}%`})})]}),(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(y,{className:`text-sm font-medium`,children:`Passing Rate`})}),(0,O.jsx)(v,{children:(0,O.jsx)(`div`,{className:`text-2xl font-bold`,children:e.passingRate===null?`N/A`:`${e.passingRate.toFixed(1)}%`})})]})]})}var M=j;function N(){let{quizId:t}=o(),n=t?parseInt(t,10):null,r=i(e=>e.courses.currentCourseId),x=s(),[S,C]=(0,D.useState)(``),[w,T]=(0,D.useState)(``),{data:E,isLoading:k}=e({...a.quizzes.statistics(r,n),errorMessage:`Failed to load quiz statistics`,fallbackValue:null,enabled:!!r&&!!n});if(k)return(0,O.jsx)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,O.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,O.jsx)(`p`,{className:`text-muted-foreground`,children:`Loading statistics...`})})});if(!E)return(0,O.jsx)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:(0,O.jsx)(`div`,{className:`flex items-center justify-center pt-8`,children:(0,O.jsx)(`p`,{className:`text-muted-foreground`,children:`No statistics available.`})})});let j=E.attempts.filter(e=>{let t=e.student.name.toLowerCase().includes(S.toLowerCase())||e.student.email.toLowerCase().includes(S.toLowerCase()),n=!w||e.student.role===w;return t&&n}),N=Array.from(new Set(E.attempts.map(e=>e.student.role)));return(0,O.jsxs)(`div`,{className:`max-w-7xl mx-auto px-6 pb-8 h-[calc(100vh-4rem)] overflow-y-auto`,children:[(0,O.jsxs)(`div`,{className:`sticky top-0 bg-background pt-8 pb-4 z-10`,children:[(0,O.jsx)(l,{variant:`ghost`,onClick:()=>x(`/courses/${r}/quizzes/${n}`),className:`mb-4`,children:`â† Back to Quiz`}),(0,O.jsxs)(`h1`,{className:`text-2xl font-bold`,children:[E.quizTitle,` - Management`]})]}),(0,O.jsxs)(`div`,{className:`space-y-6`,children:[(0,O.jsx)(M,{statistics:E}),E.highestScore!==null&&E.lowestScore!==null&&(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsx)(y,{children:`Score Range`})}),(0,O.jsx)(v,{children:(0,O.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,O.jsxs)(`div`,{children:[(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground`,children:[`Highest:`,` `]}),(0,O.jsxs)(`span`,{className:`text-lg font-semibold`,children:[E.highestScore.toFixed(1),`%`]})]}),(0,O.jsxs)(`div`,{children:[(0,O.jsxs)(`span`,{className:`text-sm text-muted-foreground`,children:[`Lowest:`,` `]}),(0,O.jsxs)(`span`,{className:`text-lg font-semibold`,children:[E.lowestScore.toFixed(1),`%`]})]})]})})]}),(0,O.jsxs)(b,{children:[(0,O.jsx)(_,{children:(0,O.jsxs)(y,{children:[`Attempts (`,j.length,`)`]})}),(0,O.jsxs)(v,{className:`space-y-4`,children:[(0,O.jsxs)(`div`,{className:`flex gap-4`,children:[(0,O.jsx)(`div`,{className:`flex-1`,children:(0,O.jsx)(g,{placeholder:`Search by name or email...`,value:S,onChange:e=>C(e.target.value)})}),(0,O.jsxs)(`div`,{className:`flex gap-x-1`,children:[(0,O.jsxs)(m,{value:w,onValueChange:T,children:[(0,O.jsx)(d,{className:c(w?`w-35`:`w-45`),children:(0,O.jsx)(u,{placeholder:`All Roles`})}),(0,O.jsx)(f,{children:N.map(e=>(0,O.jsx)(p,{value:e,children:e},e))})]}),w&&(0,O.jsx)(l,{variant:`outline`,className:`hover:text-destructive`,onClick:()=>T(``),size:`icon`,children:(0,O.jsx)(h,{})})]})]}),(0,O.jsx)(`div`,{className:`border rounded-lg overflow-hidden`,children:(0,O.jsx)(A,{attempts:j})})]})]})]})]})}const P=N;export{P as Component};